{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport { Text, Button, Card } from 'react-native-paper';\nimport axios from 'axios';\nimport Platform from \"react-native-web/dist/exports/Platform\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function TestScreen() {\n  var _useState = useState('检查中...'),\n    _useState2 = _slicedToArray(_useState, 2),\n    apiStatus = _useState2[0],\n    setApiStatus = _useState2[1];\n  var _useState3 = useState(''),\n    _useState4 = _slicedToArray(_useState3, 2),\n    baseUrl = _useState4[0],\n    setBaseUrl = _useState4[1];\n  useEffect(function () {\n    checkAPI();\n  }, []);\n  var getBaseURL = function getBaseURL() {\n    if (Platform.OS === 'web') {\n      return window.location.hostname === 'localhost' ? 'http://localhost:8080/api/v1' : `${window.location.protocol}//${window.location.hostname}:8080/api/v1`;\n    } else {\n      return 'http://localhost:8080/api/v1';\n    }\n  };\n  var checkAPI = function () {\n    var _ref = _asyncToGenerator(function* () {\n      var url = getBaseURL();\n      setBaseUrl(url);\n      try {\n        console.log('Testing API at:', url);\n        var response = yield axios.get(`${url}/health`, {\n          timeout: 5000\n        });\n        console.log('API Response:', response.data);\n        setApiStatus(`✅ API正常运行: ${response.data.message}`);\n      } catch (error) {\n        console.error('API Error:', error);\n        if (error.code === 'ECONNREFUSED') {\n          setApiStatus('❌ 无法连接到后端服务，请确保后端正在运行');\n        } else if (error.code === 'NETWORK_ERROR') {\n          setApiStatus('❌ 网络错误，请检查网络连接');\n        } else {\n          setApiStatus(`❌ API错误: ${error.message}`);\n        }\n      }\n    });\n    return function checkAPI() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n  var testRegister = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      var url = getBaseURL();\n      var testData = {\n        username: 'test_user_' + Date.now(),\n        password: 'password123'\n      };\n      try {\n        console.log('Testing registration with:', testData);\n        var response = yield axios.post(`${url}/register`, testData);\n        console.log('Registration Response:', response.data);\n        setApiStatus(`✅ 注册测试成功: ${response.data.message}`);\n      } catch (error) {\n        var _error$response, _error$response$data;\n        console.error('Registration Error:', error);\n        setApiStatus(`❌ 注册测试失败: ${((_error$response = error.response) == null ? void 0 : (_error$response$data = _error$response.data) == null ? void 0 : _error$response$data.error) || error.message}`);\n      }\n    });\n    return function testRegister() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsx(View, {\n    style: styles.container,\n    children: _jsx(Card, {\n      style: styles.card,\n      children: _jsxs(Card.Content, {\n        children: [_jsx(Text, {\n          style: styles.title,\n          children: \"API\\u8FDE\\u63A5\\u6D4B\\u8BD5\"\n        }), _jsx(Text, {\n          style: styles.label,\n          children: \"\\u5E73\\u53F0:\"\n        }), _jsx(Text, {\n          style: styles.value,\n          children: Platform.OS\n        }), _jsx(Text, {\n          style: styles.label,\n          children: \"API\\u5730\\u5740:\"\n        }), _jsx(Text, {\n          style: styles.value,\n          children: baseUrl\n        }), _jsx(Text, {\n          style: styles.label,\n          children: \"\\u72B6\\u6001:\"\n        }), _jsx(Text, {\n          style: styles.value,\n          children: apiStatus\n        }), _jsx(Button, {\n          mode: \"contained\",\n          onPress: checkAPI,\n          style: styles.button,\n          children: \"\\u91CD\\u65B0\\u68C0\\u67E5API\"\n        }), _jsx(Button, {\n          mode: \"outlined\",\n          onPress: testRegister,\n          style: styles.button,\n          children: \"\\u6D4B\\u8BD5\\u6CE8\\u518C\\u529F\\u80FD\"\n        })]\n      })\n    })\n  });\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 20,\n    backgroundColor: '#f5f5f5'\n  },\n  card: {\n    padding: 16\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 20,\n    textAlign: 'center'\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: 'bold',\n    marginTop: 12,\n    marginBottom: 4\n  },\n  value: {\n    fontSize: 14,\n    marginBottom: 8,\n    padding: 8,\n    backgroundColor: '#f0f0f0',\n    borderRadius: 4\n  },\n  button: {\n    marginTop: 16\n  }\n});","map":{"version":3,"names":["React","useState","useEffect","View","StyleSheet","Text","Button","Card","axios","Platform","jsx","_jsx","jsxs","_jsxs","TestScreen","_useState","_useState2","_slicedToArray","apiStatus","setApiStatus","_useState3","_useState4","baseUrl","setBaseUrl","checkAPI","getBaseURL","OS","window","location","hostname","protocol","_ref","_asyncToGenerator","url","console","log","response","get","timeout","data","message","error","code","apply","arguments","testRegister","_ref2","testData","username","Date","now","password","post","_error$response","_error$response$data","style","styles","container","children","card","Content","title","label","value","mode","onPress","button","create","flex","padding","backgroundColor","fontSize","fontWeight","marginBottom","textAlign","marginTop","borderRadius"],"sources":["/Users/ziyuanhe/code/booonus-aug/frontend/src/screens/TestScreen.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport { Text, Button, Card } from 'react-native-paper';\nimport axios from 'axios';\nimport { Platform } from 'react-native';\n\nexport default function TestScreen() {\n  const [apiStatus, setApiStatus] = useState('检查中...');\n  const [baseUrl, setBaseUrl] = useState('');\n\n  useEffect(() => {\n    checkAPI();\n  }, []);\n\n  const getBaseURL = () => {\n    if (Platform.OS === 'web') {\n      return window.location.hostname === 'localhost' \n        ? 'http://localhost:8080/api/v1'\n        : `${window.location.protocol}//${window.location.hostname}:8080/api/v1`;\n    } else {\n      return 'http://localhost:8080/api/v1';\n    }\n  };\n\n  const checkAPI = async () => {\n    const url = getBaseURL();\n    setBaseUrl(url);\n    \n    try {\n      console.log('Testing API at:', url);\n      const response = await axios.get(`${url}/health`, { timeout: 5000 });\n      console.log('API Response:', response.data);\n      setApiStatus(`✅ API正常运行: ${response.data.message}`);\n    } catch (error) {\n      console.error('API Error:', error);\n      if (error.code === 'ECONNREFUSED') {\n        setApiStatus('❌ 无法连接到后端服务，请确保后端正在运行');\n      } else if (error.code === 'NETWORK_ERROR') {\n        setApiStatus('❌ 网络错误，请检查网络连接');\n      } else {\n        setApiStatus(`❌ API错误: ${error.message}`);\n      }\n    }\n  };\n\n  const testRegister = async () => {\n    const url = getBaseURL();\n    const testData = {\n      username: 'test_user_' + Date.now(),\n      password: 'password123'\n    };\n\n    try {\n      console.log('Testing registration with:', testData);\n      const response = await axios.post(`${url}/register`, testData);\n      console.log('Registration Response:', response.data);\n      setApiStatus(`✅ 注册测试成功: ${response.data.message}`);\n    } catch (error) {\n      console.error('Registration Error:', error);\n      setApiStatus(`❌ 注册测试失败: ${error.response?.data?.error || error.message}`);\n    }\n  };\n\n  return (\n    <View style={styles.container}>\n      <Card style={styles.card}>\n        <Card.Content>\n          <Text style={styles.title}>API连接测试</Text>\n          \n          <Text style={styles.label}>平台:</Text>\n          <Text style={styles.value}>{Platform.OS}</Text>\n          \n          <Text style={styles.label}>API地址:</Text>\n          <Text style={styles.value}>{baseUrl}</Text>\n          \n          <Text style={styles.label}>状态:</Text>\n          <Text style={styles.value}>{apiStatus}</Text>\n          \n          <Button \n            mode=\"contained\" \n            onPress={checkAPI}\n            style={styles.button}\n          >\n            重新检查API\n          </Button>\n          \n          <Button \n            mode=\"outlined\" \n            onPress={testRegister}\n            style={styles.button}\n          >\n            测试注册功能\n          </Button>\n        </Card.Content>\n      </Card>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    padding: 20,\n    backgroundColor: '#f5f5f5',\n  },\n  card: {\n    padding: 16,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n    marginBottom: 20,\n    textAlign: 'center',\n  },\n  label: {\n    fontSize: 14,\n    fontWeight: 'bold',\n    marginTop: 12,\n    marginBottom: 4,\n  },\n  value: {\n    fontSize: 14,\n    marginBottom: 8,\n    padding: 8,\n    backgroundColor: '#f0f0f0',\n    borderRadius: 4,\n  },\n  button: {\n    marginTop: 16,\n  },\n});\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}